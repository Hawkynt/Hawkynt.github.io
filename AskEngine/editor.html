<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questionnaire Editor</title>
    <link rel="stylesheet" href="../css/shared-styles.css">
    <link rel="stylesheet" href="editor.css">
    
    <!-- Include scripts directly in head (same as main app) -->
    <script src="dnd/questions.js"></script>
    <script src="dnd/ruleset.js"></script>
    <script src="editor.js"></script>
</head>
<body>
    <div class="container" style="background:transparent!important;">
        <div class="header">
            <h1>🎲 AskEngine - Question Editor</h1>
            <p>Edit and manage D&D character creation questions</p>
            <p><a href="index.html">← Back to Questionnaire</a></p>
        </div>
        
        <div class="main-panel editor-container">
            <h2>Question Editor</h2>
            
            <div class="toolbar">
                <button onclick="loadQuestions()">📁 Load Questions</button>
                <button onclick="reloadScripts()">🔄 Reload Scripts</button>
                <button onclick="debugInfo()">🐛 Debug Info</button>
                <button onclick="addNewQuestion()">➕ Add Question</button>
                <button onclick="saveToFile()">💾 Save to File</button>
                <button onclick="copyToClipboard()">📋 Copy to Clipboard</button>
            </div>
            
            <div class="status-message" id="statusMessage"></div>
            
            <div class="question-list">
                <div class="question-sidebar" id="questionSidebar">
                    <!-- Questions will be listed here -->
                </div>
                
                <div class="question-editor" id="questionEditor">
                    <!-- Invariant question text -->
                    <div class="form-group">
                        <label>Question Text (Invariant/English):</label>
                        <textarea id="questionText" placeholder="Enter your question here..."></textarea>
                    </div>
                    
                    <!-- Language-specific question text -->
                    <div class="language-sections">
                        <div class="language-section" id="germanSection">
                            <div class="language-header" onclick="toggleLanguageSection('german')">
                                <span>🇩🇪 German Version</span>
                                <span class="toggle-icon">▼</span>
                            </div>
                            <div class="language-content" id="germanContent">
                                <div class="form-group">
                                    <label>German Question Text:</label>
                                    <textarea id="questionTextDE" placeholder="Geben Sie hier Ihre Frage ein..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="language-section" id="addLanguageSection">
                            <div class="language-header" onclick="addNewLanguage()">
                                <span>➕ Add New Language</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="multipleAnswersCheckbox" onchange="updateQuestionMultipleAnswers(this.checked)">
                            Allow Multiple Answers
                        </label>
                        <small>When checked, users can select multiple answers and a Next button will be shown</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Answers:</label>
                        <div class="answer-list" id="answerList">
                            <!-- Dynamic answer list will be inserted here -->
                        </div>
                        <button class="add-answer-btn" onclick="addAnswer()">➕ Add Answer</button>
                    </div>
                </div>
            </div>
            
            <div class="export-section">
                <h3>Export Questions</h3>
                <div class="language-tabs">
                    <div class="tab active" onclick="switchLanguage('en')">English</div>
                    <div class="tab" onclick="switchLanguage('de')">German</div>
                </div>
                <pre class="code-output" id="codeOutput">// Questions will appear here when exported</pre>
            </div>
        </div>
    </div>

    <!-- Modifier Builder Modal -->
    <div id="modifierModal" class="modifier-modal">
        <div class="modifier-modal-content">
            <h3>🎯 Build Modifier String</h3>
            <p>Adjust values for different character attributes. Positive values favor that attribute, negative values discourage it.</p>
            <div id="modifierGrid" class="modifier-grid">
                <!-- Dynamic modifier grid will be inserted here -->
            </div>
            <div class="modal-actions">
                <button onclick="cancelModifierBuilder()">Cancel</button>
                <button onclick="applyModifierBuilder()">Apply</button>
            </div>
        </div>
    </div>

</body>
</html>