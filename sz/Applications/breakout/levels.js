;(function() {
  'use strict';
  const SZ = window.SZ || (window.SZ = {});

  /*
    Brick codes:
      0        = empty
      1-5      = normal colored bricks (row color index)
      'G'      = glass brick (ball passes through, shatter effect)
      'S'      = steel brick (2 hits, crack overlay at hp=1)
      'X'      = indestructible (never destroyed, skipped in clear check)
  */

  const levels = [
    {
      name: 'Classic',
      grid: [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
        [3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        [4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
        [5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
      ]
    },
    {
      name: 'Diamond',
      grid: [
        [0, 0, 0, 0, 1, 1, 0, 0, 0, 0],
        [0, 0, 0, 2, 2, 2, 2, 0, 0, 0],
        [0, 0, 3, 3, 'G', 'G', 3, 3, 0, 0],
        [0, 4, 4, 4, 4, 4, 4, 4, 4, 0],
        [5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
        [0, 4, 4, 4, 4, 4, 4, 4, 4, 0],
        [0, 0, 3, 3, 'G', 'G', 3, 3, 0, 0],
        [0, 0, 0, 2, 2, 2, 2, 0, 0, 0],
        [0, 0, 0, 0, 1, 1, 0, 0, 0, 0]
      ]
    },
    {
      name: 'Fortress',
      grid: [
        ['X', 0, 'S', 'S', 'S', 'S', 'S', 'S', 0, 'X'],
        ['X', 0, 1, 1, 1, 1, 1, 1, 0, 'X'],
        [0, 0, 2, 'G', 'G', 'G', 'G', 2, 0, 0],
        [0, 0, 3, 3, 3, 3, 3, 3, 0, 0],
        [0, 0, 0, 4, 4, 4, 4, 0, 0, 0],
        [0, 0, 0, 0, 5, 5, 0, 0, 0, 0]
      ]
    },
    {
      name: 'Checkerboard',
      grid: [
        [1, 0, 1, 0, 1, 0, 1, 0, 1, 0],
        [0, 2, 0, 2, 0, 2, 0, 2, 0, 2],
        [3, 0, 3, 0, 'S', 0, 3, 0, 3, 0],
        [0, 4, 0, 4, 0, 4, 0, 4, 0, 4],
        [5, 0, 5, 0, 5, 0, 5, 0, 5, 0],
        [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]
      ]
    },
    {
      name: 'Glass House',
      grid: [
        ['G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G'],
        ['G', 1, 1, 1, 1, 1, 1, 1, 1, 'G'],
        ['G', 2, 'G', 'G', 'G', 'G', 'G', 'G', 2, 'G'],
        ['G', 3, 'G', 0, 0, 0, 0, 'G', 3, 'G'],
        ['G', 4, 'G', 0, 0, 0, 0, 'G', 4, 'G'],
        ['G', 5, 'G', 'G', 'G', 'G', 'G', 'G', 5, 'G'],
        ['G', 1, 1, 1, 1, 1, 1, 1, 1, 'G'],
        ['G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G', 'G']
      ]
    },
    {
      name: 'Pyramid',
      grid: [
        [0, 0, 0, 0, 'S', 'S', 0, 0, 0, 0],
        [0, 0, 0, 1, 1, 1, 1, 0, 0, 0],
        [0, 0, 2, 2, 2, 2, 2, 2, 0, 0],
        [0, 3, 3, 3, 'G', 'G', 3, 3, 3, 0],
        [4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
        ['S', 5, 5, 5, 5, 5, 5, 5, 5, 'S']
      ]
    },
    {
      name: 'Walls',
      grid: [
        ['X', 1, 1, 1, 0, 0, 1, 1, 1, 'X'],
        ['X', 2, 2, 2, 0, 0, 2, 2, 2, 'X'],
        ['X', 3, 3, 3, 0, 0, 3, 3, 3, 'X'],
        [0, 'G', 'G', 0, 'S', 'S', 0, 'G', 'G', 0],
        ['X', 4, 4, 4, 0, 0, 4, 4, 4, 'X'],
        ['X', 5, 5, 5, 0, 0, 5, 5, 5, 'X'],
        ['X', 1, 1, 1, 0, 0, 1, 1, 1, 'X']
      ]
    },
    {
      name: 'Spiral',
      grid: [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
        ['S', 3, 3, 3, 3, 3, 3, 3, 0, 2],
        ['S', 0, 0, 0, 0, 0, 0, 3, 0, 2],
        [4, 0, 'G', 'G', 'G', 0, 0, 3, 0, 2],
        [4, 0, 0, 0, 0, 0, 0, 3, 0, 2],
        [4, 5, 5, 5, 5, 5, 5, 3, 0, 2],
        [4, 0, 0, 0, 0, 0, 0, 0, 0, 2],
        [4, 1, 1, 1, 1, 1, 1, 1, 1, 1]
      ]
    },
    {
      name: 'Steel Curtain',
      grid: [
        ['S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S'],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [2, 'G', 2, 'G', 2, 'G', 2, 'G', 2, 'G'],
        ['S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S'],
        [3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        [4, 'G', 4, 'G', 4, 'G', 4, 'G', 4, 'G'],
        ['S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S']
      ]
    },
    {
      name: 'Heart',
      grid: [
        [0, 1, 1, 0, 0, 0, 0, 1, 1, 0],
        [1, 1, 1, 1, 0, 0, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 'G', 1, 1, 1, 1, 1, 1, 'G', 1],
        [0, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [0, 0, 1, 1, 1, 1, 1, 1, 0, 0],
        [0, 0, 0, 1, 1, 1, 1, 0, 0, 0],
        [0, 0, 0, 0, 1, 1, 0, 0, 0, 0]
      ]
    },
    {
      name: 'Bunker',
      grid: [
        ['X', 'X', 0, 0, 0, 0, 0, 0, 'X', 'X'],
        ['X', 'S', 'S', 0, 0, 0, 0, 'S', 'S', 'X'],
        [0, 'S', 1, 1, 'G', 'G', 1, 1, 'S', 0],
        [0, 0, 2, 2, 2, 2, 2, 2, 0, 0],
        [0, 0, 3, 3, 3, 3, 3, 3, 0, 0],
        ['X', 0, 4, 4, 'G', 'G', 4, 4, 0, 'X'],
        ['X', 'S', 5, 5, 5, 5, 5, 5, 'S', 'X'],
        ['X', 'X', 0, 0, 0, 0, 0, 0, 'X', 'X']
      ]
    },
    {
      name: 'Zigzag',
      grid: [
        [1, 1, 0, 0, 0, 0, 0, 0, 1, 1],
        [0, 2, 2, 0, 0, 0, 0, 2, 2, 0],
        [0, 0, 3, 3, 0, 0, 3, 3, 0, 0],
        [0, 0, 0, 'S', 'S', 'S', 'S', 0, 0, 0],
        [0, 0, 4, 4, 0, 0, 4, 4, 0, 0],
        [0, 5, 5, 0, 0, 0, 0, 5, 5, 0],
        [1, 1, 0, 0, 'G', 'G', 0, 0, 1, 1]
      ]
    }
  ];

  /* Procedural level generator for levels beyond the defined set */
  function generateLevel(levelNum) {
    const rows = Math.min(6 + Math.floor(levelNum / 3), 10);
    const cols = 10;
    const grid = [];
    const seed = levelNum * 7 + 13;

    for (let r = 0; r < rows; ++r) {
      const row = [];
      for (let c = 0; c < cols; ++c) {
        const hash = ((seed + r * 31 + c * 17) * 2654435761 >>> 0) % 100;
        if (hash < 8)
          row.push('X');
        else if (hash < 18)
          row.push('S');
        else if (hash < 28)
          row.push('G');
        else if (hash < 35)
          row.push(0);
        else
          row.push((r % 5) + 1);
      }
      grid.push(row);
    }
    return { name: 'Level ' + levelNum, grid };
  }

  function getLevel(levelNum) {
    const idx = levelNum - 1;
    if (idx < levels.length)
      return levels[idx];
    return generateLevel(levelNum);
  }

  SZ.BreakoutLevels = { levels, getLevel, generateLevel };
})();
